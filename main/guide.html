<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>User Guide &#8212; ConfigSpace Documentation 0.6.1 documentation</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ac9c05f7c49ca1e1f876c6e36360ea26.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />
    
  <link rel="preload" as="script" href="_static/js/index.9ea38e314b9e6d9dab77.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API" href="api/index.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
  <a class="navbar-brand" href="index.html">
  <!-- <p class="title">ConfigSpace Documentation</p> -->
  </a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/automl/ConfigSpace" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://twitter.com/automl_org?lang=de" rel="noopener" target="_blank" title="Twitter">
            <span><i class="fab fa-twitter-square"></i></span>
            <label class="sr-only">Twitter</label>
          </a>
        </li>
      </ul>
      </div>
      
      <div class="navbar-end-item">
        <div class="dropdown mt-1">
    <button type="button" class="btn btn-secondary btn-md navbar-btn dropdown-toggle" id="dLabelMore"
        data-toggle="dropdown">
        v0.6.1
        <span class="caret"></span>
    </button>
    <div class="dropdown-menu list-group-flush py-0" aria-labelledby="dLabelMore">
        <a class="list-group-item list-group-item-action" href="#">v0.6.1</a>
    </div>
</div>
      </div>
      
      <div class="navbar-end-item">
        <form class="bd-search align-items-center" action="search.html" method="get" style="width: 100%;">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control btn btn-md" name="q" id="search-input"
    placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off">
</form>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><h4 class="mt-0 mb-0"><a href="index.html">ConfigSpace Documentation</a></h4>
<div class="mb-3">v0.6.1</div><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="quickstart.html">
   Quickstart
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   User Guide
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="api/index.html">
   API
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="api/configurationspace.html">
     ConfigurationSpace
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/configuration.html">
     Configuration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/hyperparameters.html">
     Hyperparameters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/conditions.html">
     Conditions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/forbidden_clauses.html">
     Forbidden Clauses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/serialization.html">
     Serialization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="api/utils.html">
     Utils
    </a>
   </li>
  </ul>
 </li>
</ul>

  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#st-example-integer-hyperparameters-and-float-hyperparameters">
   1st Example: Integer hyperparameters and float hyperparameters
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nd-example-categorical-hyperparameters-and-conditions">
   2nd Example: Categorical hyperparameters and conditions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rd-example-forbidden-clauses">
   3rd Example: Forbidden clauses
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#th-example-serialization">
   4th Example Serialization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#th-example-placing-priors-on-the-hyperparameters">
   5th Example: Placing priors on the hyperparameters
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="user-guide">
<h1>User Guide<a class="headerlink" href="#user-guide" title="Permalink to this heading">¶</a></h1>
<p>In this user guide, the concepts of using different hyperparameters, applying
conditions and forbidden clauses to
a configuration space are explained.</p>
<p>These concepts will be introduced by defining a more complex configuration space
for a support vector machine.</p>
<section id="st-example-integer-hyperparameters-and-float-hyperparameters">
<h2>1st Example: Integer hyperparameters and float hyperparameters<a class="headerlink" href="#st-example-integer-hyperparameters-and-float-hyperparameters" title="Permalink to this heading">¶</a></h2>
<p>Assume that we want to use a support vector machine (=SVM) for classification
tasks and therefore, we want to optimize its hyperparameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\mathcal{C}\)</span>: regularization constant  with <span class="math notranslate nohighlight">\(\mathcal{C} \in \mathbb{R}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_iter</span></code>: the maximum number of iterations within the solver with <span class="math notranslate nohighlight">\(max\_iter \in \mathbb{N}\)</span></p></li>
</ul>
<p>The implementation of the classifier is out of scope and thus not shown.
But for further reading about
support vector machines and the meaning of its hyperparameter, you can continue
reading <a class="reference external" href="https://en.wikipedia.org/wiki/Support_vector_machine">here</a> or
in the <a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC">scikit-learn documentation</a>.</p>
<p>The first step is always to create a
<a class="reference internal" href="api/configurationspace.html#ConfigSpace.configuration_space.ConfigurationSpace" title="ConfigSpace.configuration_space.ConfigurationSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigurationSpace</span></code></a> with the
hyperparameters <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> and <code class="docutils literal notranslate"><span class="pre">max_iter</span></code>.</p>
<p>To restrict the search space, we choose <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> to be a
<a class="reference internal" href="api/hyperparameters.html#module-ConfigSpace.api.types.float" title="ConfigSpace.api.types.float"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> between -1 and 1.
Furthermore, we choose <code class="docutils literal notranslate"><span class="pre">max_iter</span></code> to be an <a class="reference internal" href="api/hyperparameters.html#ConfigSpace.api.types.integer.Integer" title="ConfigSpace.api.types.integer.Integer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Integer</span></code></a> .</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">ConfigurationSpace</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">ConfigurationSpace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">space</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>  <span class="c1"># Note the decimal to make it a float</span>
<span class="gp">... </span>        <span class="s2">&quot;max_iter&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>For demonstration  purpose, we sample a configuration from it.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">sample_configuration</span><span class="p">()</span>
<span class="go">Configuration(values={</span>
<span class="go">  &#39;C&#39;: -0.6169610992422154,</span>
<span class="go">  &#39;max_iter&#39;: 66,</span>
<span class="go">})</span>
</pre></div>
</div>
<p>Now, the <a class="reference internal" href="api/configurationspace.html#ConfigSpace.configuration_space.ConfigurationSpace" title="ConfigSpace.configuration_space.ConfigurationSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigurationSpace</span></code></a> object <em>cs</em>
contains definitions of the hyperparameters <span class="math notranslate nohighlight">\(\mathcal{C}\)</span> and <code class="docutils literal notranslate"><span class="pre">max_iter</span></code> with their
value-ranges.</p>
<p id="st-example">Sampled instances from a <a class="reference internal" href="api/configurationspace.html#ConfigSpace.configuration_space.ConfigurationSpace" title="ConfigSpace.configuration_space.ConfigurationSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigurationSpace</span></code></a>
are called <a class="reference internal" href="api/configuration.html#ConfigSpace.configuration_space.Configuration" title="ConfigSpace.configuration_space.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configuration</span></code></a>.
In a <a class="reference internal" href="api/configuration.html#ConfigSpace.configuration_space.Configuration" title="ConfigSpace.configuration_space.Configuration"><code class="xref py py-class docutils literal notranslate"><span class="pre">Configuration</span></code></a> object, the value
of a parameter can be accessed or modified similar to a python dictionary.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span> <span class="o">=</span> <span class="n">cs</span><span class="o">.</span><span class="n">sample_configuration</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;max_iter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">conf</span><span class="p">[</span><span class="s1">&#39;max_iter&#39;</span><span class="p">])</span>
<span class="go">42</span>
</pre></div>
</div>
</section>
<section id="nd-example-categorical-hyperparameters-and-conditions">
<h2>2nd Example: Categorical hyperparameters and conditions<a class="headerlink" href="#nd-example-categorical-hyperparameters-and-conditions" title="Permalink to this heading">¶</a></h2>
<p>The scikit-learn SVM supports different kernels, such as an RBF, a sigmoid,
a linear or a polynomial kernel. We want to include them in the configuration space.
Since this new hyperparameter has a finite number of values, we use a
<a class="reference internal" href="api/hyperparameters.html#module-ConfigSpace.api.types.categorical" title="ConfigSpace.api.types.categorical"><code class="xref py py-class docutils literal notranslate"><span class="pre">categorical</span></code></a>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kernel_type</span></code>: with values ‘linear’, ‘poly’, ‘rbf’, ‘sigmoid’.</p></li>
</ul>
<p>Taking a look at the SVM documentation, we observe that if the kernel type is
chosen to be ‘poly’, another hyperparameter <code class="docutils literal notranslate"><span class="pre">degree</span></code> must be specified.
Also, for the kernel types ‘poly’ and ‘sigmoid’, there is an additional hyperparameter <code class="docutils literal notranslate"><span class="pre">coef0</span></code>.
As well as the hyperparameter <code class="docutils literal notranslate"><span class="pre">gamma</span></code> for the kernel types ‘rbf’, ‘poly’ and ‘sigmoid’.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">degree</span></code>: the degree of a polynomial kernel function, being <span class="math notranslate nohighlight">\(\in \mathbb{N}\)</span></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">coef0</span></code>: Independent term in kernel function. It is only significant in ‘poly’ and ‘sigmoid’.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gamma</span></code>: Kernel coefficient for ‘rbf’, ‘poly’ and ‘sigmoid’.</p></li>
</ul>
<p>To realize the different hyperparameter for the kernels, we use <a class="reference internal" href="api/conditions.html#conditions"><span class="std std-ref">Conditions</span></a>.</p>
<p>Even in simple examples, the configuration space grows easily very fast and
with it the number of possible configurations.
It makes sense to limit the search space for hyperparameter optimizations in
order to quickly find good configurations. For conditional hyperparameters
(= hyperparameters which only take a value if some condition is met), ConfigSpace
achieves this by sampling those hyperparameters from the configuration
space only if their condition is met.</p>
<p>To add conditions on hyperparameters to the configuration space, we first have
to insert the new hyperparameters in the <code class="docutils literal notranslate"><span class="pre">ConfigSpace</span></code> and in a second step, the
conditions on them.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">ConfigurationSpace</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">Float</span><span class="p">,</span> <span class="n">Integer</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">kernel_type</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;kernel_type&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">,</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">degree</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="s1">&#39;degree&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coef0</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="s1">&#39;coef0&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gamma</span> <span class="o">=</span> <span class="n">Float</span><span class="p">(</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e2</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">ConfigurationSpace</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">add_hyperparameters</span><span class="p">([</span><span class="n">kernel_type</span><span class="p">,</span> <span class="n">degree</span><span class="p">,</span> <span class="n">coef0</span><span class="p">,</span> <span class="n">gamma</span><span class="p">])</span>
<span class="go">[kernel_type, Type: Categorical, Choices: {linear, poly, rbf, sigmoid}, ...]</span>
</pre></div>
</div>
<p>First, we define the conditions. Conditions work by constraining a child
hyperparameter (the first argument) on its parent hyperparameter (the second argument)
being in a certain relation to a value (the third argument).
<code class="docutils literal notranslate"><span class="pre">EqualsCondition(degree,</span> <span class="pre">kernel_type,</span> <span class="pre">'poly')</span></code> expresses that <code class="docutils literal notranslate"><span class="pre">degree</span></code> is
constrained on <code class="docutils literal notranslate"><span class="pre">kernel_type</span></code> being equal to the value ‘poly’.  To express
constraints involving multiple parameters or values, we can use conjunctions.
In the following example, <code class="docutils literal notranslate"><span class="pre">cond_2</span></code> describes that <code class="docutils literal notranslate"><span class="pre">coef0</span></code>
is a valid hyperparameter, if the <code class="docutils literal notranslate"><span class="pre">kernel_type</span></code> has either the value
‘poly’ or ‘sigmoid’.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">EqualsCondition</span><span class="p">,</span> <span class="n">OrConjunction</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond_1</span> <span class="o">=</span> <span class="n">EqualsCondition</span><span class="p">(</span><span class="n">degree</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond_2</span> <span class="o">=</span> <span class="n">OrConjunction</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">EqualsCondition</span><span class="p">(</span><span class="n">coef0</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">EqualsCondition</span><span class="p">(</span><span class="n">coef0</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond_3</span> <span class="o">=</span> <span class="n">OrConjunction</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">EqualsCondition</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="s1">&#39;rbf&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">EqualsCondition</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="s1">&#39;poly&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">EqualsCondition</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="s1">&#39;sigmoid&#39;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>In this specific example, you may wish to use the <a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.InCondition" title="ConfigSpace.conditions.InCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">InCondition</span></code></a> to express
that <code class="docutils literal notranslate"><span class="pre">gamma</span></code> is valid if <code class="docutils literal notranslate"><span class="pre">kernel_type</span> <span class="pre">in</span> <span class="pre">[&quot;rbf&quot;,</span> <span class="pre">&quot;poly&quot;,</span> <span class="pre">&quot;sigmoid&quot;]</span></code> which we show for completness</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">InCondition</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cond_3</span> <span class="o">=</span> <span class="n">InCondition</span><span class="p">(</span><span class="n">gamma</span><span class="p">,</span> <span class="n">kernel_type</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;rbf&quot;</span><span class="p">,</span> <span class="s2">&quot;poly&quot;</span><span class="p">,</span> <span class="s2">&quot;sigmoid&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally, we add the conditions to the configuration space</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">add_conditions</span><span class="p">([</span><span class="n">cond_1</span><span class="p">,</span> <span class="n">cond_2</span><span class="p">,</span> <span class="n">cond_3</span><span class="p">])</span>
<span class="go">[degree | kernel_type == &#39;poly&#39;, (coef0 | kernel_type == &#39;poly&#39; || coef0 | ...), ...]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ConfigSpace offers a lot of different condition types. For example the
<a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.NotEqualsCondition" title="ConfigSpace.conditions.NotEqualsCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">NotEqualsCondition</span></code></a>,
<a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.LessThanCondition" title="ConfigSpace.conditions.LessThanCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">LessThanCondition</span></code></a>,
or <a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.GreaterThanCondition" title="ConfigSpace.conditions.GreaterThanCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">GreaterThanCondition</span></code></a>.
To read more about conditions, please take a look at the <a class="reference internal" href="api/conditions.html#conditions"><span class="std std-ref">Conditions</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t use either the <a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.EqualsCondition" title="ConfigSpace.conditions.EqualsCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">EqualsCondition</span></code></a> or the
<a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.InCondition" title="ConfigSpace.conditions.InCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">InCondition</span></code></a> on float hyperparameters.
Due to floating-point inaccuracy, it is very unlikely that the
<a class="reference internal" href="api/conditions.html#ConfigSpace.conditions.EqualsCondition" title="ConfigSpace.conditions.EqualsCondition"><code class="xref py py-class docutils literal notranslate"><span class="pre">EqualsCondition</span></code></a> is evaluated to True.</p>
</div>
</section>
<section id="rd-example-forbidden-clauses">
<h2>3rd Example: Forbidden clauses<a class="headerlink" href="#rd-example-forbidden-clauses" title="Permalink to this heading">¶</a></h2>
<p>It may occur that some states in the configuration space are not allowed.
ConfigSpace supports this functionality by offering <a class="reference internal" href="api/forbidden_clauses.html#forbidden-clauses"><span class="std std-ref">Forbidden Clauses</span></a>.</p>
<p>We demonstrate the usage of <a class="reference internal" href="api/forbidden_clauses.html#forbidden-clauses"><span class="std std-ref">Forbidden Clauses</span></a> by defining the
configuration space for the
<a class="reference external" href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.LinearSVC.html#sklearn.svm.LinearSVC">linear SVM</a>.
Again, we use the sklearn implementation. This implementation has three
hyperparameters to tune:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">penalty</span></code>: Specifies the norm used in the penalization with values ‘l1’ or ‘l2’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">loss</span></code>: Specifies the loss function with values ‘hinge’ or ‘squared_hinge’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dual</span></code>: Solves the optimization problem either in the dual or simple form with values True or False</p></li>
</ul>
<p>Because some combinations of <code class="docutils literal notranslate"><span class="pre">penalty</span></code>, <code class="docutils literal notranslate"><span class="pre">loss</span></code> and <code class="docutils literal notranslate"><span class="pre">dual</span></code> just don’t work
together, we want to make sure that these combinations are not sampled from the
configuration space.</p>
<p>First, we add these three new hyperparameters to the configuration space.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">ConfigurationSpace</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">Constant</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">penalty</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;penalty&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;l1&quot;</span><span class="p">,</span> <span class="s2">&quot;l2&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;l2&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">Categorical</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;hinge&quot;</span><span class="p">,</span> <span class="s2">&quot;squared_hinge&quot;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;squared_hinge&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dual</span> <span class="o">=</span> <span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;dual&quot;</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">add_hyperparameters</span><span class="p">([</span><span class="n">penalty</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">dual</span><span class="p">])</span>
<span class="go">[penalty, Type: Categorical, Choices: {l1, l2}, Default: l2, ...]</span>
</pre></div>
</div>
<p>Now, we want to forbid the following hyperparameter combinations:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">penalty</span></code> is ‘l1’ and <code class="docutils literal notranslate"><span class="pre">loss</span></code> is ‘hinge’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dual</span></code> is False and <code class="docutils literal notranslate"><span class="pre">penalty</span></code> is ‘l2’ and <code class="docutils literal notranslate"><span class="pre">loss</span></code> is ‘hinge’</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dual</span></code> is False and <code class="docutils literal notranslate"><span class="pre">penalty</span></code> is ‘l1’</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">ForbiddenEqualsClause</span><span class="p">,</span> <span class="n">ForbiddenAndConjunction</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">penalty_and_loss</span> <span class="o">=</span> <span class="n">ForbiddenAndConjunction</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">penalty</span><span class="p">,</span> <span class="s2">&quot;l1&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="s2">&quot;hinge&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">constant_penalty_and_loss</span> <span class="o">=</span> <span class="n">ForbiddenAndConjunction</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">dual</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">penalty</span><span class="p">,</span> <span class="s2">&quot;l2&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="s2">&quot;hinge&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">penalty_and_dual</span> <span class="o">=</span> <span class="n">ForbiddenAndConjunction</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">dual</span><span class="p">,</span> <span class="s2">&quot;False&quot;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">ForbiddenEqualsClause</span><span class="p">(</span><span class="n">penalty</span><span class="p">,</span> <span class="s2">&quot;l1&quot;</span><span class="p">)</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p>In the last step, we add them to the configuration space object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="o">.</span><span class="n">add_forbidden_clauses</span><span class="p">([</span><span class="n">penalty_and_loss</span><span class="p">,</span> <span class="n">constant_penalty_and_loss</span><span class="p">,</span> <span class="n">penalty_and_dual</span><span class="p">])</span>
<span class="go">[(Forbidden: penalty == &#39;l1&#39; &amp;&amp; Forbidden: loss == &#39;hinge&#39;), ...]</span>
</pre></div>
</div>
</section>
<section id="th-example-serialization">
<h2>4th Example Serialization<a class="headerlink" href="#th-example-serialization" title="Permalink to this heading">¶</a></h2>
<p>If you want to use the configuration space in another tool, such as
<a class="reference external" href="https://github.com/automl/CAVE">CAVE</a>, it is useful to store it to file.
To serialize the <a class="reference internal" href="api/configurationspace.html#ConfigSpace.configuration_space.ConfigurationSpace" title="ConfigSpace.configuration_space.ConfigurationSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigurationSpace</span></code></a>,
we can choose between different output formats, such as
<a class="reference internal" href="api/serialization.html#json"><span class="std std-ref">json</span></a> or <a class="reference internal" href="api/serialization.html#pcs-new"><span class="std std-ref">pcs</span></a>.</p>
<p>In this example, we want to store the <a class="reference internal" href="api/configurationspace.html#ConfigSpace.configuration_space.ConfigurationSpace" title="ConfigSpace.configuration_space.ConfigurationSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigurationSpace</span></code></a>
object as json file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace.read_and_write</span> <span class="kn">import</span> <span class="n">json</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;configspace.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cs</span><span class="p">))</span>
<span class="go">2828</span>
</pre></div>
</div>
<p>To read it from file</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;configspace.json&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
<span class="gp">... </span>  <span class="n">json_string</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">restored_conf</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">json_string</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="th-example-placing-priors-on-the-hyperparameters">
<h2>5th Example: Placing priors on the hyperparameters<a class="headerlink" href="#th-example-placing-priors-on-the-hyperparameters" title="Permalink to this heading">¶</a></h2>
<p>If you want to conduct black-box optimization in SMAC (<a class="reference external" href="https://arxiv.org/abs/2109.09831">https://arxiv.org/abs/2109.09831</a>), and you have prior knowledge about the which regions of the search space are more likely to contain the optimum, you may include this knowledge when designing the configuration space. More specifically, you place prior distributions over the optimum on the parameters, either by a (log)-normal or (log)-Beta distribution. SMAC then considers the given priors through the optimization by using PiBO (<a class="reference external" href="https://openreview.net/forum?id=MMAeCXIa89">https://openreview.net/forum?id=MMAeCXIa89</a>).</p>
<p>Consider the case of optimizing the accuracy of an MLP with three hyperparameters: learning rate [1e-5, 1e-1], dropout [0, 0.99] and activation {Tanh, ReLU}. From prior experience, you believe the optimal learning rate to be around 1e-3, a good dropout to be around 0.25, and the optimal activation function to be ReLU about 80% of the time. This can be represented accordingly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">ConfigSpace</span> <span class="kn">import</span> <span class="n">ConfigurationSpace</span><span class="p">,</span> <span class="n">Float</span><span class="p">,</span> <span class="n">Categorical</span><span class="p">,</span> <span class="n">Beta</span><span class="p">,</span> <span class="n">Normal</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># convert 10 log to natural log for learning rate, mean 1e-3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># with two standard deviations on either side of the mean to cover the search space</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logmean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">logstd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="n">ConfigurationSpace</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">seed</span><span class="o">=</span><span class="mi">1234</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">space</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>      <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="n">Float</span><span class="p">(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">Normal</span><span class="p">(</span><span class="n">logmean</span><span class="p">,</span> <span class="n">logstd</span><span class="p">)),</span>
<span class="gp">... </span>      <span class="s2">&quot;dropout&quot;</span><span class="p">:</span> <span class="n">Float</span><span class="p">(</span><span class="s1">&#39;dropout&#39;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="n">Beta</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">4</span><span class="p">)),</span>
<span class="gp">... </span>      <span class="s2">&quot;activation&quot;</span><span class="p">:</span> <span class="n">Categorical</span><span class="p">(</span><span class="s1">&#39;activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;tanh&#39;</span><span class="p">,</span> <span class="s1">&#39;relu&#39;</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]),</span>
<span class="gp">... </span>    <span class="p">}</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cs</span><span class="p">)</span>
<span class="go">Configuration space object:</span>
<span class="go">  Hyperparameters:</span>
<span class="go">    activation, Type: Categorical, Choices: {tanh, relu}, Default: tanh, Probabilities: (0.2, 0.8)</span>
<span class="go">    dropout, Type: BetaFloat, Alpha: 2.0 Beta: 4.0, Range: [0.0, 0.99], Default: 0.25</span>
<span class="go">    lr, Type: NormalFloat, Mu: -6.907755278982137 Sigma: 2.302585092994046, Range: [1e-05, 0.1], Default: 0.001, on log-scale</span>
</pre></div>
</div>
<p>To check that your prior makes sense for each hyperparameter, you can easily do so with the <code class="docutils literal notranslate"><span class="pre">__pdf__</span></code> method. There, you will see that the probability of the optimal learning rate peaks at 10^-3, and decays as we go further away from it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test_points</span><span class="p">)</span>
<span class="go">[1.e-05 1.e-04 1.e-03 1.e-02 1.e-01]</span>
</pre></div>
</div>
<p>The pdf function accepts an (N, ) numpy array as input.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">test_points</span><span class="p">)</span>
<span class="go">array([0.02456573, 0.11009594, 0.18151753, 0.11009594, 0.02456573])</span>
</pre></div>
</div>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="quickstart.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Quickstart</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="api/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="_static/js/index.9ea38e314b9e6d9dab77.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright Copyright 2023, Matthias Feurer, Katharina Eggensperger, Syed Mohsin Ali, Christina Hernandez Wunsch, Julien-Charles Levesque, Jost Tobias Springenberg, Philipp Mueller, Marius Lindauer, Jorn Tuyls, Eddie Bergman, Arjun Krishnakumar.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a>
7.0.1. Template is modified version of <a
href="https://pydata-sphinx-theme.readthedocs.io">PyData Sphinx Theme</a>. <br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>